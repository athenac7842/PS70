<!DOCTYPE html>
<html lang="en">
<head>
    <title>Athena's Projects</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <link rel="stylesheet" href="assets/styledoc.css" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/arduino-light.min.css">
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/highlight.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/arduino.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
</head>
<body>    
    <img src="assets/images/week4/box_full.jpg" width= "40%"/>
    <br></br>
    <p>
        I decided to use the capacitors as an alarm clock where you have to touch them together to turn it off. There is a switch to allow it to be turned on and off. Through the code the time until the noise begins can be adjusted.
    </p>
    <img src="assets/images/week4/wires_pre.jpg"width= "40%"/>
    <img src="assets/images/week4/wires_post.jpg" width= "40%"/>
    <p>
        I am using Rob's microcontroller. This controller worked better than the Adafruit one, and did not require me to download the driver for Metro (which I was having difficulty with) for capactive touch.
    </p>
    <br></br>
    <img src="assets/images/week4/arduinoinside.JPG" width= "70%"/>
    <br></br>
    <p>
        The Arduino was programed to be delayed.
        <a href=""> Download code soon to be implemented </a>
        <pre><code class="language-arduino">
            //tx_rx03  Robert Hart Mar 2019.
            //  Program to use transmit-receive across space between two conductors.
            //  One conductor attached to digital pin, another to analog pin.
            //
            //  This program has a function "tx_rx() which returns the value in a long integer.
            //
            //  Optionally, two resistors (1 MOhm or greater) can be placed between 5V and GND, with
            //  the signal connected between them so that the steady-state voltage is 2.5 Volts.
            //
            //  Signal varies with electric field coupling between conductors, and can
            //  be used to measure many things related to position, overlap, and intervening material
            //  between the two conductors.
            //


            long result;   //variable for the result of the tx_rx measurement.
            int analog_pin = 2;
            int tx_pin = 9;
            int switch_pin = 13;
            int tone_pin= 5;
            int t = 0; //sets for else

            void setup() {
                pinMode(tx_pin, OUTPUT);      //Pin 4 provides the voltage step
                pinMode(switch_pin, INPUT);
                Serial.begin(9600);
            }


            long tx_rx(){         //Function to execute rx_tx algorithm and return a value
                                //that depends on coupling of two electrodes.
                                //Value returned is a long integer.
                int read_high;
                int read_low;
                int diff;
                long int sum;
                int N_samples = 200;    //Number of samples to take.  Larger number slows it down, but reduces scatter.
                int t=0; //to be used to signal off
                sum = 0;

                for (int i = 0; i < N_samples; i++){
                    digitalWrite(tx_pin,HIGH);              //Step the voltage high on conductor 1.
                    read_high = analogRead(analog_pin);        //Measure response of conductor 2.
                    delayMicroseconds(100);            //Delay to reach steady state.
                    digitalWrite(tx_pin,LOW);               //Step the voltage to zero on conductor 1.
                    read_low = analogRead(analog_pin);         //Measure response of conductor 2.
                    diff = read_high - read_low;       //desired answer is the difference between high and low.
                    sum += diff;                       //Sums up N_samples of these measurements.
                }
                return sum;
            }                         
            //End of tx_rx function.


            void loop() {

                //switch on
                if (digitalRead(switch_pin) == HIGH){
                    t = 0;
                    //resets t
                    if (result > 50000) {
                      int pitch1 = result/800;
                      tone(tone_pin, pitch1);
                    }
                    else{
                      noTone(tone_pin);
                      delay(1000);
                    }
                }       
                //switch off
                else{
                    if (t == 0){
                        tone(tone_pin, 400, 100);
                        tone(tone_pin, 300, 100);
                        tone(tone_pin, 200, 100);
                        t = 1;
                    }
                }
            }
        </code></pre>
    </p>
    <img src="assets/images/week4/ledoff.JPG"width= "50%"/> 
    <img src="assets/images/week4/ledon.JPG" width= "50%"/>
    <br></br>
    <img src="assets/images/week4/wires.JPG"width= "60%"/> 
</body>
</html>